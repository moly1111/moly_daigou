{% extends "admin/base.html" %}

{% block page_title %}创建用户{% endblock %}

{% block page_actions %}
<a href="{{ url_for('admin.admin_users') }}" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> 返回列表</a>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-8">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">账户信息</h6>
      </div>
      <div class="card-body">
        <form method="POST" autocomplete="off">
          <div class="mb-3">
            <label class="form-label">邮箱 *</label>
            <input type="email" class="form-control" name="email" required autocomplete="off">
          </div>
          <div class="mb-3">
            <label class="form-label">用户名（可选）</label>
            <input type="text" class="form-control" name="username" 
                   pattern="[a-zA-Z0-9_]{3,20}" maxlength="20" placeholder="3-20位字母数字下划线" autocomplete="off">
            <div class="form-text">设置后用户可使用用户名登录</div>
          </div>
          <div class="mb-3">
            <label class="form-label">密码 *</label>
            <input type="password" class="form-control" name="password" minlength="6" required autocomplete="new-password">
            <div class="form-text">无需邮箱验证，创建后用户可直接登录</div>
          </div>
          <div class="mb-3">
            <label class="form-label">备注</label>
            <textarea class="form-control" name="notes" rows="3" placeholder="管理员备注信息" autocomplete="off"></textarea>
          </div>

          <h6 class="mt-4">收货地址（可选）</h6>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">收货人</label>
              <input class="form-control" name="name" autocomplete="off">
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">手机号</label>
              <input class="form-control" name="phone" autocomplete="off">
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">地址</label>
            <textarea class="form-control" name="address_text" rows="3" autocomplete="off"></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">邮编</label>
            <input class="form-control" name="postal_code" autocomplete="off">
          </div>

          <div class="d-flex justify-content-between">
            <a href="{{ url_for('admin.admin_users') }}" class="btn btn-secondary">取消</a>
            <button type="submit" class="btn btn-primary"><i class="bi bi-check-circle"></i> 创建</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card shadow">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">说明</h6>
      </div>
      <div class="card-body">
        <ul class="text-muted small mb-0">
          <li>创建的用户无需邮箱验证，立即可用</li>
          <li>如填写完整地址信息，将为该用户同时创建收货地址</li>
          <li>后续可在用户编辑页修改信息或封禁/解封</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 强制清除所有输入字段的值
    const inputs = document.querySelectorAll('input, textarea');
    inputs.forEach(input => {
        input.value = '';
        input.setAttribute('value', '');
    });
    
    // 防止浏览器自动填充
    const form = document.querySelector('form');
    if (form) {
        form.setAttribute('autocomplete', 'off');
    }
});
</script>
{% endblock %}


